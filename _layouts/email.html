{% include header.html %}

<script>
    // data content
    const email = {
        recipients: `{{ page.recipients | join: ',' }}`.split(','),
        subject: `{{ page.subject }}`,
        body: `{{ page.body }}`
    }

    {% if page.cc %}
        email.cc = `{{ page.cc | join: ',' }}`.split(',')
    {% endif %}

</script>

<div class="content emailPageHeader">
    <div class="container">
		<h2>{{ page.name }}</h2>
		<b>{{ page.city }}, {{ page.state }}</b><br /> {{ site.email_intro_text | markdownify }}
		<p id="autoopen">{{ site.auto_open_message }}</p>
		<div class='buttons'>
			<a id='send-system-email'>Send email</a>
			<a onclick="copyToClipboard(this, `{{ page.permalink }}`, true)">Copy link</a>
		</div>
        <p>{{ site.bad_mailto_message }}</p>
        <div class="template-fill-tab">
            <p><span class="tab-caret"> > </span> Fill using template form</p>
            <div class="template-fill"></div>
        </div>
    </div>
</div>

<div class="content emailContentSection">
    <div class="container">
        <div class="emailContent">
            <div class="recipients">
                <b>To:</b> <div id="recipients-list"></div>
                <span class="copyToClipboard" onclick="copyToClipboard(this, `${email.recipients.join(',')}`)">ðŸ”—</span>
			</div>
			{% if page.cc %}
			<div class="cc">
                <b>CC:</b> <div id="cc-list"></div>
                <span class="copyToClipboard" onclick="copyToClipboard(this, `${email.cc.join(',')}`)">ðŸ”—</span>
			</div>
			{% endif %}
            <div class="subject">
                <b>Subject:</b> {{ page.subject }}
                <span class="copyToClipboard" onclick="copyToClipboard(this, `${email.subject}`)">ðŸ”—</span>
			</div>
            <div class="body">
                <b>Message</b> <i>(Don't forget to replace the [x]'s with your information!)</i>
                <span class="copyToClipboard" onclick="copyToClipboard(this, `${$('.email-contents').text()}`)">ðŸ”—</span>
                <br />
                <div class="email-contents">
                    {{ page.body | markdownify }}
                </div>
            </div>
        </div>
    </div>
</div>

{% include list.html %}

<script src="/js/email.js"></script>
<script type="text/javascript">
    $(document).ready(() => {
        renderEmail()
        const params = getParams(window.location.href)

        // if (params.browse !== undefined) {
		// 	$("#autoopen").hide()
		// 	// Automatically updates the URL so if folks try to share, it will auto-open
		// 	window.history.replaceState({}, document.title, `${window.location.origin}{{ page.permalink }}`)
		// } else {
		// 	openSystemEmailClient()
        // }
        
        $('#send-system-email').click(function(){
            openSystemEmailClient()
        })
    })
    
</script>

{% include footer.html %}